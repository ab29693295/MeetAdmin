{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst createHash = require(\"./util/createHash\");\n\nconst validateOptions = require(\"schema-utils\");\n\nconst schema = require(\"../schemas/plugins/HashedModuleIdsPlugin.json\");\n/** @typedef {import(\"../declarations/plugins/HashedModuleIdsPlugin\").HashedModuleIdsPluginOptions} HashedModuleIdsPluginOptions */\n\n\nclass HashedModuleIdsPlugin {\n  /**\n   * @param {HashedModuleIdsPluginOptions=} options options object\n   */\n  constructor(options) {\n    if (!options) options = {};\n    validateOptions(schema, options, \"Hashed Module Ids Plugin\");\n    /** @type {HashedModuleIdsPluginOptions} */\n\n    this.options = Object.assign({\n      context: null,\n      hashFunction: \"md4\",\n      hashDigest: \"base64\",\n      hashDigestLength: 4\n    }, options);\n  }\n\n  apply(compiler) {\n    const options = this.options;\n    compiler.hooks.compilation.tap(\"HashedModuleIdsPlugin\", compilation => {\n      const usedIds = new Set();\n      compilation.hooks.beforeModuleIds.tap(\"HashedModuleIdsPlugin\", modules => {\n        for (const module of modules) {\n          if (module.id === null && module.libIdent) {\n            const id = module.libIdent({\n              context: this.options.context || compiler.options.context\n            });\n            const hash = createHash(options.hashFunction);\n            hash.update(id);\n            const hashId =\n            /** @type {string} */\n            hash.digest(options.hashDigest);\n            let len = options.hashDigestLength;\n\n            while (usedIds.has(hashId.substr(0, len))) len++;\n\n            module.id = hashId.substr(0, len);\n            usedIds.add(module.id);\n          }\n        }\n      });\n    });\n  }\n\n}\n\nmodule.exports = HashedModuleIdsPlugin;","map":{"version":3,"sources":["E:/Users/cnki/source/repos/ab29693295/MeetAdmin/node_modules/webpack/lib/HashedModuleIdsPlugin.js"],"names":["createHash","require","validateOptions","schema","HashedModuleIdsPlugin","constructor","options","Object","assign","context","hashFunction","hashDigest","hashDigestLength","apply","compiler","hooks","compilation","tap","usedIds","Set","beforeModuleIds","modules","module","id","libIdent","hash","update","hashId","digest","len","has","substr","add","exports"],"mappings":"AAAA;;;;AAIA;;AACA,MAAMA,UAAU,GAAGC,OAAO,CAAC,mBAAD,CAA1B;;AAEA,MAAMC,eAAe,GAAGD,OAAO,CAAC,cAAD,CAA/B;;AACA,MAAME,MAAM,GAAGF,OAAO,CAAC,+CAAD,CAAtB;AAEA;;;AAEA,MAAMG,qBAAN,CAA4B;AAC3B;;;AAGAC,EAAAA,WAAW,CAACC,OAAD,EAAU;AACpB,QAAI,CAACA,OAAL,EAAcA,OAAO,GAAG,EAAV;AAEdJ,IAAAA,eAAe,CAACC,MAAD,EAASG,OAAT,EAAkB,0BAAlB,CAAf;AAEA;;AACA,SAAKA,OAAL,GAAeC,MAAM,CAACC,MAAP,CACd;AACCC,MAAAA,OAAO,EAAE,IADV;AAECC,MAAAA,YAAY,EAAE,KAFf;AAGCC,MAAAA,UAAU,EAAE,QAHb;AAICC,MAAAA,gBAAgB,EAAE;AAJnB,KADc,EAOdN,OAPc,CAAf;AASA;;AAEDO,EAAAA,KAAK,CAACC,QAAD,EAAW;AACf,UAAMR,OAAO,GAAG,KAAKA,OAArB;AACAQ,IAAAA,QAAQ,CAACC,KAAT,CAAeC,WAAf,CAA2BC,GAA3B,CAA+B,uBAA/B,EAAwDD,WAAW,IAAI;AACtE,YAAME,OAAO,GAAG,IAAIC,GAAJ,EAAhB;AACAH,MAAAA,WAAW,CAACD,KAAZ,CAAkBK,eAAlB,CAAkCH,GAAlC,CACC,uBADD,EAECI,OAAO,IAAI;AACV,aAAK,MAAMC,MAAX,IAAqBD,OAArB,EAA8B;AAC7B,cAAIC,MAAM,CAACC,EAAP,KAAc,IAAd,IAAsBD,MAAM,CAACE,QAAjC,EAA2C;AAC1C,kBAAMD,EAAE,GAAGD,MAAM,CAACE,QAAP,CAAgB;AAC1Bf,cAAAA,OAAO,EAAE,KAAKH,OAAL,CAAaG,OAAb,IAAwBK,QAAQ,CAACR,OAAT,CAAiBG;AADxB,aAAhB,CAAX;AAGA,kBAAMgB,IAAI,GAAGzB,UAAU,CAACM,OAAO,CAACI,YAAT,CAAvB;AACAe,YAAAA,IAAI,CAACC,MAAL,CAAYH,EAAZ;AACA,kBAAMI,MAAM;AAAG;AAAuBF,YAAAA,IAAI,CAACG,MAAL,CACrCtB,OAAO,CAACK,UAD6B,CAAtC;AAGA,gBAAIkB,GAAG,GAAGvB,OAAO,CAACM,gBAAlB;;AACA,mBAAOM,OAAO,CAACY,GAAR,CAAYH,MAAM,CAACI,MAAP,CAAc,CAAd,EAAiBF,GAAjB,CAAZ,CAAP,EAA2CA,GAAG;;AAC9CP,YAAAA,MAAM,CAACC,EAAP,GAAYI,MAAM,CAACI,MAAP,CAAc,CAAd,EAAiBF,GAAjB,CAAZ;AACAX,YAAAA,OAAO,CAACc,GAAR,CAAYV,MAAM,CAACC,EAAnB;AACA;AACD;AACD,OAnBF;AAqBA,KAvBD;AAwBA;;AA/C0B;;AAkD5BD,MAAM,CAACW,OAAP,GAAiB7B,qBAAjB","sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\nconst createHash = require(\"./util/createHash\");\n\nconst validateOptions = require(\"schema-utils\");\nconst schema = require(\"../schemas/plugins/HashedModuleIdsPlugin.json\");\n\n/** @typedef {import(\"../declarations/plugins/HashedModuleIdsPlugin\").HashedModuleIdsPluginOptions} HashedModuleIdsPluginOptions */\n\nclass HashedModuleIdsPlugin {\n\t/**\n\t * @param {HashedModuleIdsPluginOptions=} options options object\n\t */\n\tconstructor(options) {\n\t\tif (!options) options = {};\n\n\t\tvalidateOptions(schema, options, \"Hashed Module Ids Plugin\");\n\n\t\t/** @type {HashedModuleIdsPluginOptions} */\n\t\tthis.options = Object.assign(\n\t\t\t{\n\t\t\t\tcontext: null,\n\t\t\t\thashFunction: \"md4\",\n\t\t\t\thashDigest: \"base64\",\n\t\t\t\thashDigestLength: 4\n\t\t\t},\n\t\t\toptions\n\t\t);\n\t}\n\n\tapply(compiler) {\n\t\tconst options = this.options;\n\t\tcompiler.hooks.compilation.tap(\"HashedModuleIdsPlugin\", compilation => {\n\t\t\tconst usedIds = new Set();\n\t\t\tcompilation.hooks.beforeModuleIds.tap(\n\t\t\t\t\"HashedModuleIdsPlugin\",\n\t\t\t\tmodules => {\n\t\t\t\t\tfor (const module of modules) {\n\t\t\t\t\t\tif (module.id === null && module.libIdent) {\n\t\t\t\t\t\t\tconst id = module.libIdent({\n\t\t\t\t\t\t\t\tcontext: this.options.context || compiler.options.context\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tconst hash = createHash(options.hashFunction);\n\t\t\t\t\t\t\thash.update(id);\n\t\t\t\t\t\t\tconst hashId = /** @type {string} */ (hash.digest(\n\t\t\t\t\t\t\t\toptions.hashDigest\n\t\t\t\t\t\t\t));\n\t\t\t\t\t\t\tlet len = options.hashDigestLength;\n\t\t\t\t\t\t\twhile (usedIds.has(hashId.substr(0, len))) len++;\n\t\t\t\t\t\t\tmodule.id = hashId.substr(0, len);\n\t\t\t\t\t\t\tusedIds.add(module.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n}\n\nmodule.exports = HashedModuleIdsPlugin;\n"]},"metadata":{},"sourceType":"script"}